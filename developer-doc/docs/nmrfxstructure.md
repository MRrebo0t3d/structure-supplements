# NMRFx Structure

NMRFx Structure can be used to generate and analyze macromolecular structures.  It can be ran in two different ways.  First, if the command is invoked with one of several subcommands (gen, batch, score, predict) a predefined mode will be executed.  Alternatively, one can simply give as an argument a Python (actually Jython) script which will be executed.  The script has access to standard Python functions (including the standard Python library) and to specific commands provided by the NMRFx Structure program's Java code.

The predifined subcommands are listed below.

# List of subcommands :

## 1. gen

```nmrfxstructure gen projectFile seed```

Generate a single structure using data specified in a project file and initializing the random number generator with a specified seed.  This is useful for testing out the project file before generating a whole family of structures with the batch command.  An *output* directory will be created if not present.  After successful execution, the generated pdb and violations file will be written to that directory.  The output files will have the seed number appended to them (i.e. temp0.pdb, temp0.txt etc.).

__Example__: 
`nmrfxstructure gen project.yaml 0`

## 2. batch

```nmrfxstructure batch -n nStructures -k keepNStructures -p useNProcesses -a projectFile``` 

Generate a family of structures using the data specified in a project file.  An *output* directory and *final* directory will be created if not present.  All generated structures will be written to files (temp1.pdb, temp2.pdb ...) in this directory.  A violation file (temp1.txt, temp2.text ...) will also be written.  The best structures, along with their violation files, will be written to the *final* directory. Multiple files are generated by repeatedly invoking the **nmrfxstructure gen** command with the specified project file and an incremented seed number.   The number of invocations running simultaneously will be specified by the **-p** argument.

__Example__: 
`nmrfxstructure batch -n 100 -k 10 -p 5 -a project.yaml 0`

**-n** *nStructures* 
:  The total number of structures to generate.
	
**-k** *keepNStructures*
:  Specify the number of structures to keep (and write to the *final* directory).  The structures with lowest total target function will be kept.

**-p** *useNProcesses* 
:  Structure generation can be sped up by running multiple structure calculation processes simultaneously.  This argument specifies the number of simultaneous calculations to perform.

**-s** *startNumber* 
:  Starting number for seed. This defaults to 0, but if you want to run batch a second time and generate additional structures you can specify this value.  Also used when submitting batch commands to multiple computers for higher level of parallelization.


**-a**
:  If this argument is specified then the structures will be automatically aligned and written to a new set of files (super1.pdb, super2.pdb ...).  During alignment defined regions of the structure (lower residue rms) will be identified and used for the alignmnent.


## 3. score

```nmrfxstructure score ?-o outDir? ?-p pdbs? ?-y projectFile? ?pdbFile1.pdb pdbFile2.pdb ...?```

**-y** *projectFile* 
:  The project file that defines constraints to be used in the analysis.

**-o** *outDir* 
:  The directory in which to write output files.  Defaults to *analysis*.

**-p** *pdbFilePattern* 
:  PDB files can be specified as an argument to this command.  This argument will result in execution of a Python level glob command to search for files that match the specified pattern. If wild card characters (*) are specified, then the whole pattern needs to be included in single quotes.

__Examples__:

* `nmrfxstructure score -y project.yaml pdb/\*.pdb`

* `nmrfxstructure score -y project.yaml -p 'pdb/\*.pdb'`

## 4. predict

*Information pending....*


	
	
